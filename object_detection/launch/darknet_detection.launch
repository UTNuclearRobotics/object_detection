<?xml version="1.0" encoding="utf-8"?>
<launch>

  <arg name="robot" default="walrus"/>
  <arg name="camera_name" default="realsense_front"/>
  <arg name="camera_image_name" default="color"/>

  <group ns="$(arg robot)">
    <!-- ###########################  Yolo ############################# -->
    <node pkg="darknet_ros" type="darknet_ros" name="darknet_ros" output="log">
      <rosparam command="load" file="$(find darknet_ros)/config/yolov3.yaml"/>
      <rosparam command="load" file="$(find object_detection)/config/darknet_ros.yaml"/>
      <param name="subscribers/camera_reading/topic" value="/$(arg robot)/$(arg camera_name)/$(arg camera_image_name)/image_raw"/>

      <param name="weights_path"          value="$(find darknet_ros)/yolo_network_config/weights" />
      <param name="config_path"           value="$(find darknet_ros)/yolo_network_config/cfg" />
    </node>

    <!-- ###########################  Image Snapshot ########################## -->
    <node pkg="image_processing" type="image_snapshot" name="image_snapshot" output="screen">
      <param name="stale_time" value="1.0"/>
      <!-- <remap from="image" to="$(arg camera)/color/image_raw"/> -->
      <remap from="image" to="darknet_ros/detection_image"/>
      <remap from="image/compressed" to="$(arg camera_name)/$(arg camera_image_name)/image_raw/compressed"/>
      <remap from="camera_info" to="$(arg camera_name)/$(arg camera_image_name)/camera_info"/>
    </node>
  </group>
</launch>
